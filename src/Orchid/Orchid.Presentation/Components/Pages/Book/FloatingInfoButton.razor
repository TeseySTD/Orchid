@implements IAsyncDisposable
@inject IJSRuntime Js

<div @ref="_buttonContainer" class="floating-btn-wrapper">
    <MudTooltip Text="Book Info" Placement="Placement.Left">
        <MudIconButton Icon="@Icons.Material.Filled.Info"
                       Color="Color.Primary"
                       Variant="Variant.Filled"
                       Size="Size.Small"
                       OnClick="OnClick"/>
    </MudTooltip>
</div>

@code {
    [Parameter] public EventCallback OnClick { get; set; }

    private ElementReference _buttonContainer;
    private IJSObjectReference? _module;

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            _module = await Js.InvokeAsync<IJSObjectReference>("import",
                "./Components/Pages/Book/FloatingInfoButton.razor.js");

            await _module.InvokeVoidAsync("init", _buttonContainer, 2000);
        }
    }

    public async ValueTask DisposeAsync()
    {
        if (_module is not null)
        {
            try
            {
                await _module.InvokeVoidAsync("dispose", _buttonContainer);
                await _module.DisposeAsync();
            }
            catch (JSDisconnectedException)
            {
                // Ignore - Js connection is interrupted
            }
        }
    }
}
